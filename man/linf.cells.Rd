% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/linf.R
\name{linf.cells}
\alias{linf.cells}
\title{Assign L-infinity cell (dominant feature) per sample — indices & labels}
\usage{
linf.cells(S)
}
\arguments{
\item{S}{Numeric matrix (samples x features), nonnegative. Can be raw counts
or relative abundances (e.g., L1- or L-infinity-normalized). Must be finite
(no \code{NA}/\code{NaN}/\code{Inf}) and have positive dimensions.}
}
\value{
A list with four elements:
\describe{
\item{\code{index}}{Integer vector (length \code{nrow(S)}). The 1-based
column index of the dominant feature per row; \code{NA_integer_} for
all-zero rows. Row names (if any) are preserved as names.}
\item{\code{label}}{Character vector (length \code{nrow(S)}). The feature
label corresponding to \code{index}; \code{NA_character_} for all-zero
rows. Row names (if any) are preserved as names.}
\item{\code{levels}}{Character vector (length \code{ncol(S)}). The full,
column-ordered set of feature labels (after \code{make.unique}), in 1–1
correspondence with column indices. Use this for reliable label↔index
mapping.}
\item{\code{observed.levels}}{Character vector of the subset of
\code{levels} that actually appear in \code{label}, in column order
(deterministic). Useful for compact summaries.}
}
}
\description{
For each sample (row) of a nonnegative matrix, identifies the \eqn{L^\infty}
cell as the column with the maximum value. Ties are broken by the first
maximum (as in \code{max.col(..., ties.method = "first")}). Rows that are all
zero are assigned \code{NA}.
}
\details{
Column labels are taken from \code{colnames(S)}; if absent, synthetic labels
\code{"V1", "V2", ..., "Vp"} are generated. To guarantee a 1–1 mapping between
columns and labels, duplicate column names are disambiguated via
\code{make.unique()}.
\itemize{
\item The dominant-feature assignment is invariant under positive row scaling, so
counts or relatives are both acceptable inputs. For consistency with
\emph{L-infinity}-based workflows, consider using \code{\link{normalize.linf}}
before calling this function.
\item All-zero rows are detected via \code{rowSums(S != 0) == 0} and assigned
\code{NA} in both \code{index} and \code{label}.
}
}
\examples{
# Basic example with named columns
S <- rbind(
  a = c(A = 10, B = 5,  C = 0),   # -> A
  b = c(A = 0,  B = 0,  C = 0),   # -> NA
  c = c(A = 1,  B = 4,  C = 4)    # tie -> first max: B
)
out <- linf.cells(S)
out$index
out$label
out$levels
out$observed.levels

# Unnamed columns (synthetic labels V1..Vp), duplicate names disambiguated
T <- matrix(c(0,2,  3,1,  0,0), nrow = 3, byrow = TRUE)
colnames(T) <- c("X", "X")  # duplicates -> X, X_1
linf.cells(T)$levels

# With L-infinity normalization in a pipeline
M <- normalize.linf(S)
linf.cells(M)$label

}
\seealso{
\code{\link{normalize.linf}}, \code{\link{linf.csts}}
}
